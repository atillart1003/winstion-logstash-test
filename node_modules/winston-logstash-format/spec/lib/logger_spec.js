describe('logger', () => {
  'use strict';

  it ('double checks the singleton state', () => {
    expect(require('../../lib/winston-logstash-format')).toBe(require('../../lib/winston-logstash-format'));
  });
});

describe('output format', () => {
  'use strict';

  const intercept = require('intercept-stdout');
  const logger    = require('../../lib/winston-logstash-format');

  let output = '';

  let stopIntercept = intercept(function(text) {
    output += text;
  });

  it ('outputs json as a logstash format', () => {
    logger.info('message');

    stopIntercept();

    expect(output).toMatch('{"@timestamp":".+Z","@version":1,"environment":"test","message":"message","severity":"info"}');
  });
});
